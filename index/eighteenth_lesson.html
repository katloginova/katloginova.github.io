<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Восемнадцатый урок</title>
    <link rel="icon" href="../img/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="../css/style.css">

</head>

<body>
    <div class="container">
        <header>
            <div class="head">
                <div class="logo">
                    <div class="logo-img"></div>
                    <h1>Курс Front-end</h1>
                </div>
                <h2>Восемнадцатый урок</h2>
            </div>

            <nav>
                <a href="../index.html">главная</a>
                <a href="targets.html">мои цели</a>
                <a href="layouts.html">макеты</a>
                <a href="content.html">содержание уроков</a>

            </nav>
        </header>

        <main>
            <div class="leftbar">
                <img src="../img/main/foto.jpg" alt="foto">
                <ul>
                    <li><a href="first_lesson.html">первый урок</a></li>
                    <li><a href="second_lesson.html">второй урок</a></li>
                    <li><a href="third_lesson.html">третий урок</a></li>
                    <li><a href="fourth_lesson.html">четвертый урок</a></li>
                    <li><a href="fifth_lesson.html">пятый урок</a></li>
                    <li><a href="sixth_lesson.html">шестой урок</a></li>
                    <li><a href="seventh_lesson.html">седьмой урок</a></li>
                    <li><a href="eighth_lesson.html">восьмой урок</a></li>
                    <li><a href="ninth_lesson.html">девятый урок</a></li>
                    <li><a href="tenth_lesson.html">десятый и одиннадцатый уроки</a></li>
                    <li><a href="twelveth_lesson.html">двенадцатый урок</a></li>
                    <li><a href="thirteenth_lesson.html">тринадцатый урок</a></li>
                    <li><a href="fourteenth_lesson.html">четырнадцатый урок</a></li>
                    <li><a href="fifteenth_lesson.html">пятнадцатый урок</a></li>
                    <li><a href="sixteenth_lesson.html">шестнадцатый урок</a></li>
                    <li><a href="seventeenth_lesson.html">семнадцатый урок</a></li>
                    <li><a href="#">восемнадцатый урок</a></li>
                    <li><a href="nineteenth_lesson.html">девятнадцатый урок</a></li>

                </ul>
            </div>

            <div class="content">
                <div class="title">Сборщик задач Gulp <a href="https://github.com/katloginova/gulp-example" class="content-italic">(https://github.com/katloginova/gulp-example)</a></div>

                <div class="content-text">
                   <p>
                        <span>Gulp</span> – это таск-менеджер для автоматического выполнения часто используемых задач (например, минификации, тестирования, объединения файлов), написанный на языке программирования JavaScript. Программное обеспечение использует командную строку для запуска задач, определённых в файле <span>gulpfile.js</span>.
                   </p>
                   <p>
                        Для начала разобьём наш проект на две части: исходный код (src) и результирующий (dist), который получен путем компиляции при помощи gulp.
                   </p>
                   <p>
                        Устанавка утилиты командной строки «gulp»:
                   </p>
                </div>

                <div class="content-italic">
                    npm i -g gulp-cli
                </div>
                <div class="content-text">
                    Для того, чтобы сделать инициализацию проекта используется команда (делается это один раз «за всю жизнь» проекта) внутри папки проекта:
                </div>
                <div class="content-italic">
                    npm init
                </div>
                <div class="content-text">
                    В результате инициализации появится целый ряд вопросов, на которые необходимо ответить, чтобы сконфигурировать node.js в проекте:
                    <ul>
                        <li>
                            Имя проекта/пакета
                        </li>
                        <li>
                            Версия приложения
                        </li>
                        <li>
                            Описание
                        </li>
                        <li>
                            Точка входа (используется в случае, если приложение JS)
                        </li>
                        <li>
                            Тестовая команда
                        </li>
                        <li>
                            Git репозиторий (можно не указывать)
                        </li>
                        <li>
                            Ключевые слова (используется, если выкладывается библиотека и по этим словам ищут эту библиотеку)
                        </li>
                        <li>
                            Автор
                        </li>
                        <li>
                            Лицензия
                        </li>
                        <li>
                            Результат (сгенерированный файл «package.json») / yes
                        </li>
                    </ul>
                </div>

                <div class="content-text">
                    В файле <span>«package.json»</span> записываются все необходимые зависимости, которые используются в проекте (библиотеки, модули). Добавлять зависимости можно вручную, а можно с помощью командной строки с помощью ключа «--save-dev». Т.е. когда мы устанавливаем какой-либо npm-пакет дописываем в конце данный ключ, и тогда он автоматически впишется в файл «package.json», как зависимость.
                </div>

                <div class="content-text">
                    Теперь перейдем к установки библиотеки сборщика задач «gulp»:
                </div>
                <div class="content-italic">
                    npm i gulp –save-dev
                </div>

                <div class="content-text">
                    После установки появится папка «node_modules», которую необходимо добавить в «.gitignore», а также файл «package-lock.json».
                </div>
                <div class="content-text">
                    Но если необходимо использовать все библиотеки, которые прописаны в «package.json» на другом компьютере после скачивания проекта с удаленного репозитория, то для этого прописывается команда «npm instal».
                </div>

                <div class="content-text">
                    Затем создадим файл конфигурации «gulp» под названием «gulpfile.js», где и будем задавать необходимые задачи для «gulp», которые помогут нам автоматизировать наш проект. В данном файле в самом начале задаются переменные, которым присваиваются устанавливаемые библиотеки или модули:
                </div>
                <div class="content-italic">
                    var gulp/имя переменной/ = require(‘gulp’)/значение в данном случае библиотека «gulp»/
                </div>

                <div class="content-text">
                    После уже задается эти переменным (библиотекам) необходимые задачи. Задаются задачи следующим образом:
                </div>
                <div class="content-italic">
                    gulp.task(‘имя функции’, () => {что должно выполнятся});
                </div>

                <div class="content-text">
                    Если «имя функции» называется «default», то его можно не прописывать в командной строке оно выполняется по умолчанию. Можно также выполнять несколько задач сразу или по очереди:
                </div>

                <div class="content-italic">
                    gulp.task(‘default’, gulp.series(‘функция1’, ‘функция2’));  /выполняются по очереди/
                </div>

                <div class="content-italic">
                    gulp.task(‘default’, gulp.parallel(‘функция1’, ‘функция2’));  /выполняются параллельно/
                </div>

                <div class="content-text">
                    Теперь перейдем к конкретным задачам. Для начала зададим задачу для копирования статичных файлов из папки «src» в папку «dist» следующим образом:
                </div>

                <div class="content-text" style="display: flex; justify-content: center;">
                    <img class="img-small" src="../img/concpect/lesson18/copy.JPG" alt="copy" >
                </div>

                <div class="content-italic">
                    gulp.task('default', gulp.series('copy-html', 'copy-images')); /выполняет поочередное копирование указанных папок/
                </div>

                <div class="content-text">
                    Далее нам необходимо аналогично скопировать папки «styles», но при этом преобразовать файлы, находящиеся в исходной папке «src» с расширением «.scss» в файлы с расширение «.css», которые будут находится в результирующей папке «dist». Для этого установим модуль «gulp-sass»:
                </div>

                <div class="content-italic">
                    npm i gulp-sass –save-dev
                </div>

                <div class="content-text">
                    И после этого создадим задачу, преобразующую в другойформат, а затем копирующую в результирующую папку:
                </div>

                <div class="content-text">
                    <img class="img-medium" src="../img/concpect/lesson18/sass.JPG" alt="sass" >
                </div>

                <div class="content-text">
                    Для удобства создадим задачу, которая будет следить за изменениями в наших файлах проекта:
                </div>

                <div class="content-text">
                    <img class="img-medium" src="../img/concpect/lesson18/watch.JPG" alt="watch">
                </div>

                <div class="content-italic">
                    gulp.task('build', gulp.series('copy-html', 'copy-images', 'sass'));
                </div>
                <div class="content-italic">
                    gulp.task('default', gulp.series('build', 'watch')); /выполняет сначала копирование файлов, а затем следит за их изменениями/
                </div>

                <div class="content-text">
                    Установим модуль синхронизации с браузером «browser-sync», который не является модулем библиотеки «gulp», но очень хорошо совместим с этой библиотекой:
                </div>

                <div class="content-italic">
                    npm i browser-sync –save-dev
                </div>

                <div class="content-text">
                    После установки, как обычно создадим переменную, но при этом используем метод создания элемента поскольку «» не принадлежит библиотеки «gulp»:
                </div>

                <div class="content-italic">
                    var browserSync =require('browser-sync').create(); 
                </div>

                <div class="content-text">
                    После создадим следующую задачу, которая будет синхронизировать наш проект с браузером:
                </div>

                <div class="content-text" style="display: flex; justify-content: center;">
                    <img class="img-small" src="../img/concpect/lesson18/sync.JPG" alt="sync">
                </div>

                <div class="content-italic">
                    gulp.task('build', gulp.series('copy-html', 'copy-images', 'sass'));
                </div>
                <div class="content-italic">
                    gulp.task('buid-watch', gulp.series('build', 'watch'));
                </div>
                <div class="content-italic">
                    gulp.task('default', gulp.parallel('build-watch', 'sync'));
                </div>

                <div class="content-text">
                    Но этого недостаточно, чтобы наш проект обновлялся с каждым нашим изменением. Для этого необходимо для всех существующих задач добавить еще одну операцию:
                </div>
                <div class="content-italic">
                    .pipe(browserSync.stream());
                </div>

                <div class="content-text">
                    Т.е. выглядить это должно следующим образом:
                </div>
                <div class="content-text" style="display: flex; justify-content: center;">
                    <img class="img-small" src="../img/concpect/lesson18/copy-stream.JPG" alt="copy-stream">
                </div>

                <h3 class="subtitle">PostCSS</h3>

                <div class="content-text">
                    <span>PostCSS</span> – это библиотека, содержащая различные модули необходимые для обработки уже готового css-файла. Самыми распространенными плагинами «postcss» являются:
                    <ul>
                        <li>
                            плагин, который минимизирует css-файл, убирая все пробелы из кода – <span>«cssnano»</span>
                        </li>
                        <li>
                            плагин, который добавляет префиксы, где они необходимы, что более ранние версии браузеров поддерживали наш проект – <span>«autoprefixer»</span>
                        </li>
                    </ul>
                </div>

                <div class="content-text">
                    Для установки всех необходимых модулей библиотеки «postcss» используем команду:
                </div>
                <div class="content-italic">
                    npm i postcss –save-dev  /это отдельная библиотека, которая необходимо для того, чтобы работал модуль «gulp-postcss»/
                </div>

                <div class="content-italic">
                    npm i gulp-postcss –save-dev  /это модуль «postcss» библиотеки «gulp»/
                </div>

                <div class="content-text">
                    И все по старой схеме создаем переменную библиотеки «postcss»:
                </div>

                <div class="content-italic">
                    var postcss = require('gulp-postcss');
                </div>

                <div class="content-text">
                    И когда библиотека установлена можно устанавливать ее плагины необходимые для проекта, например, «cssnano»:
                </div>
                <div class="content-italic">
                    npm i cssnano –save-dev
                </div>

                <div class="content-text">
                    Создадим задачу, где переменная:
                </div>

                <div class="content-italic">
                    var cssnano = require('cssnano');
                </div>

                <div class="content-text">
                    а сама задача:
                </div>
                <div class="content-italic">
                    var postcssPlugins = [cssnano()];
                </div>

                
                <div class="content-text" style="display: flex; justify-content: center;">
                    <img class="img-small" src="../img/concpect/lesson18/cssnano.JPG" alt="cssnano">
                </div>


                <div class="content-text">
                    Установим плагин «autoprefixer» аналогичным образом:
                </div>
                <div class="content-italic">
                    npm i autoprefixer –save-dev
                </div>

                <div class="content-text">
                    Создадим переменную и добавим ее в ранее созданный массив «postcssPlugins» с плагинами библиотеки «postcss»:
                </div>
                <div class="content-italic">
                    var autoprefix = require('autoprefixer');
                </div>
                <div class="content-italic">
                    var postcssPlugins = [
                        autoprefix(),
                        cssnano()
                    ];
                </div>

                <div class="content-text">
                    Плагин «cssnano» лучше задавать в конце массива, поскольку он минимизирует css-файл.
                </div>
                <div class="content-text">
                    Но для того, чтобы этот плагин работал необходимо указать под какие версии браузера он должен адаптировать минимизирует css-файл. Заходим на официальный сайт с документацией <a href="https://postcss.org/">https://postcss.org/</a>, выбираем вкладку «Plugins» и находим «autoprefixer». Где будет описано, как указывать версии браузера в файле «package.json», копируем и в вставляем в данный файл:
                </div>

                <div class="content-text" style="display: flex; justify-content: center;">
                    <img class="img-small" src="../img/concpect/lesson18/brow-list.JPG" alt="brow-list">
                </div>


                <div class="content-text">
                    Можно код немного упростить, указав на 3 последних версии. После чего «package.json» будет выглядеть:
                </div>

                <div class="content-text">
                    <img class="img-medium" src="../img/concpect/lesson18/package_json.JPG" alt="package_json">
                </div>

                <div class="content-text">
                    Для переименования файлов необходимо использовать плагин «gulp-rename»:
                </div>
                <div class="content-italic">
                    npm i gulp-rename –save-dev
                </div>
                <div class="content-italic">
                    var rename = require('gulp-rename');
                </div>

                <div class="content-text">
                    <img class="img-medium" src="../img/concpect/lesson18/rename.JPG" alt="rename">
                </div>

                <div class="content-text">
                    Еще один очень важный плагин «gulp-clean», который может помочь очисть результирующую папку проекта «dist» от ненужных файлов. Идея состоит в том, что мы сначала удаляем все содержимое данной папки, а затем копируем содержимое папки «src» в эту папку. И так при каждом изменение проекта. И все по старой схеме устанавливаем пакет, создаем переменную и задаем задачу для «gulp»:
                </div>

            </div>

        </main>

        <footer>
            Логинова Екатерина &copy
        </footer>
    </div>
</body>

</html>